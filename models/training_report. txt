
################################################################################
# COMPLETE MODEL TRAINING PIPELINE
# Training Date: 2025-11-27 00:15:19
# Data Source: REALISTIC (with anomalies)
################################################################################

================================================================================
STEP 0: DATA PREPARATION
================================================================================
ğŸ“‚ Loading data from: C:\Users\DEV\Desktop\Minor Project\Project\Data\generate_visualize\synthetic_indian_load_data.csv
   âœ“ Loaded 316,224 rows, 36 states
   âœ“ Dropped 0 rows with missing targets

ğŸ“ˆ Adding time-series features...
   Lags: [1, 2, 3, 24, 168]
   Rolling windows: [3, 24, 168]
   âœ“ Dropped 6048 rows with NaN features

ğŸ“Š Time-based split (70/15/15)...
   Train: 217,123 samples
   Val:   46,526 samples
   Test:  46,527 samples

   Features (16): 
   State_Code, Hour_Of_Day, Day_Of_Week, Is_Weekend, Is_Holiday_State, Avg_Temp_C, Temp_Change_6H, Avg_Humidity_Pct, Load_lag_1h, Load_lag_2h, Load_lag_3h, Load_lag_24h, Load_lag_168h, Load_roll_mean_3h, Load_roll_mean_24h, Load_roll_mean_168h

================================================================================
STEP 1: TRAINING GLOBAL MODEL
================================================================================

ğŸ”§ Building global LightGBM model...
   Architecture: OneHotEncoder(State_Code) + LightGBM Regressor
ğŸ“š Training on 217123 samples...

ğŸ“Š Evaluating on validation set...
   MAE:  1192.32 MW
   RMSE: 3639.43 MW
   MAPE: 4.99%

ğŸ“Š Evaluating on test set...
   MAE:  2604.57 MW
   RMSE: 8537.60 MW
   MAPE: 5.71%

ğŸ’¾ Saving global model to: C:\Users\DEV\Desktop\Minor Project\models\global_model.joblib
   âœ“ Model saved

================================================================================
STEP 2: TRAINING PER-STATE RESIDUAL MODELS
================================================================================
Threshold: Only keep models that improve global RMSE by > 5.0%

[1/36] Training residual model for state: AN
        ğŸ“š Training on 6031 samples...
        Global RMSE:    46.06 MW
        Corrected RMSE: 22.32 MW
        Improvement:    51.53%
        âœ… SAVED (improvement > 5.0%)
[2/36] Training residual model for state: AP
        ğŸ“š Training on 6031 samples...
        Global RMSE:    1157.60 MW
        Corrected RMSE: 2287.42 MW
        Improvement:    -97.60%
        âŒ NOT saved (improvement < 5.0%)
[3/36] Training residual model for state: AR
        ğŸ“š Training on 6032 samples...
        Global RMSE:    1080.70 MW
        Corrected RMSE: 781.38 MW
        Improvement:    27.70%
        âœ… SAVED (improvement > 5.0%)
[4/36] Training residual model for state: AS
        ğŸ“š Training on 6031 samples...
        Global RMSE:    361.44 MW
        Corrected RMSE: 1644.17 MW
        Improvement:    -354.89%
        âŒ NOT saved (improvement < 5.0%)
[5/36] Training residual model for state: BH
        ğŸ“š Training on 6031 samples...
        Global RMSE:    602.06 MW
        Corrected RMSE: 1726.75 MW
        Improvement:    -186.81%
        âŒ NOT saved (improvement < 5.0%)
[6/36] Training residual model for state: CH
        ğŸ“š Training on 6031 samples...
        Global RMSE:    1333.15 MW
        Corrected RMSE: 2259.32 MW
        Improvement:    -69.47%
        âŒ NOT saved (improvement < 5.0%)
[7/36] Training residual model for state: CHH
        ğŸ“š Training on 6031 samples...
        Global RMSE:    900.01 MW
        Corrected RMSE: 2219.92 MW
        Improvement:    -146.66%
        âŒ NOT saved (improvement < 5.0%)
[8/36] Training residual model for state: DL
        ğŸ“š Training on 6031 samples...
        Global RMSE:    1994.29 MW
        Corrected RMSE: 4217.53 MW
        Improvement:    -111.48%
        âŒ NOT saved (improvement < 5.0%)
[9/36] Training residual model for state: DNHD
        ğŸ“š Training on 6031 samples...
        Global RMSE:    410.27 MW
        Corrected RMSE: 1644.82 MW
        Improvement:    -300.91%
        âŒ NOT saved (improvement < 5.0%)
[10/36] Training residual model for state: GA
        ğŸ“š Training on 6031 samples...
        Global RMSE:    104.97 MW
        Corrected RMSE: 86.80 MW
        Improvement:    17.31%
        âœ… SAVED (improvement > 5.0%)
[11/36] Training residual model for state: GJ
        ğŸ“š Training on 6032 samples...
        Global RMSE:    2150.68 MW
        Corrected RMSE: 2698.02 MW
        Improvement:    -25.45%
        âŒ NOT saved (improvement < 5.0%)
[12/36] Training residual model for state: HP
        ğŸ“š Training on 6031 samples...
        Global RMSE:    3551.26 MW
        Corrected RMSE: 4851.29 MW
        Improvement:    -36.61%
        âŒ NOT saved (improvement < 5.0%)
[13/36] Training residual model for state: HR
        ğŸ“š Training on 6031 samples...
        Global RMSE:    1151.70 MW
        Corrected RMSE: 3989.86 MW
        Improvement:    -246.43%
        âŒ NOT saved (improvement < 5.0%)
[14/36] Training residual model for state: JH
        ğŸ“š Training on 6031 samples...
        Global RMSE:    901.19 MW
        Corrected RMSE: 2506.90 MW
        Improvement:    -178.18%
        âŒ NOT saved (improvement < 5.0%)
[15/36] Training residual model for state: JK
        ğŸ“š Training on 6031 samples...
        Global RMSE:    2469.20 MW
        Corrected RMSE: 3305.75 MW
        Improvement:    -33.88%
        âŒ NOT saved (improvement < 5.0%)
[16/36] Training residual model for state: KA
        ğŸ“š Training on 6031 samples...
        Global RMSE:    1696.38 MW
        Corrected RMSE: 1824.29 MW
        Improvement:    -7.54%
        âŒ NOT saved (improvement < 5.0%)
[17/36] Training residual model for state: KL
        ğŸ“š Training on 6031 samples...
        Global RMSE:    696.56 MW
        Corrected RMSE: 1155.63 MW
        Improvement:    -65.91%
        âŒ NOT saved (improvement < 5.0%)
[18/36] Training residual model for state: LA
        ğŸ“š Training on 6031 samples...
        Global RMSE:    2910.36 MW
        Corrected RMSE: 1762.47 MW
        Improvement:    39.44%
        âœ… SAVED (improvement > 5.0%)
[19/36] Training residual model for state: LD
        ğŸ“š Training on 6032 samples...
        Global RMSE:    42.44 MW
        Corrected RMSE: 18.79 MW
        Improvement:    55.72%
        âœ… SAVED (improvement > 5.0%)
[20/36] Training residual model for state: MH
        ğŸ“š Training on 6031 samples...
        Global RMSE:    9484.56 MW
        Corrected RMSE: 9265.62 MW
        Improvement:    2.31%
        âŒ NOT saved (improvement < 5.0%)
[21/36] Training residual model for state: ML
        ğŸ“š Training on 6031 samples...
        Global RMSE:    100.96 MW
        Corrected RMSE: 456.40 MW
        Improvement:    -352.04%
        âŒ NOT saved (improvement < 5.0%)
[22/36] Training residual model for state: MN
        ğŸ“š Training on 6031 samples...
        Global RMSE:    297.86 MW
        Corrected RMSE: 1227.11 MW
        Improvement:    -311.98%
        âŒ NOT saved (improvement < 5.0%)
[23/36] Training residual model for state: MP
        ğŸ“š Training on 6031 samples...
        Global RMSE:    1698.39 MW
        Corrected RMSE: 2574.38 MW
        Improvement:    -51.58%
        âŒ NOT saved (improvement < 5.0%)
[24/36] Training residual model for state: MZ
        ğŸ“š Training on 6031 samples...
        Global RMSE:    120.96 MW
        Corrected RMSE: 833.21 MW
        Improvement:    -588.83%
        âŒ NOT saved (improvement < 5.0%)
[25/36] Training residual model for state: NL
        ğŸ“š Training on 6032 samples...
        Global RMSE:    173.46 MW
        Corrected RMSE: 800.18 MW
        Improvement:    -361.31%
        âŒ NOT saved (improvement < 5.0%)
[26/36] Training residual model for state: OD
        ğŸ“š Training on 6032 samples...
        Global RMSE:    564.16 MW
        Corrected RMSE: 1781.67 MW
        Improvement:    -215.81%
        âŒ NOT saved (improvement < 5.0%)
[27/36] Training residual model for state: PB
        ğŸ“š Training on 6031 samples...
        Global RMSE:    1186.45 MW
        Corrected RMSE: 2367.67 MW
        Improvement:    -99.56%
        âŒ NOT saved (improvement < 5.0%)
[28/36] Training residual model for state: PD
        ğŸ“š Training on 6031 samples...
        Global RMSE:    143.83 MW
        Corrected RMSE: 595.89 MW
        Improvement:    -314.29%
        âŒ NOT saved (improvement < 5.0%)
[29/36] Training residual model for state: RJ
        ğŸ“š Training on 6031 samples...
        Global RMSE:    12687.85 MW
        Corrected RMSE: 12804.46 MW
        Improvement:    -0.92%
        âŒ NOT saved (improvement < 5.0%)
[30/36] Training residual model for state: SK
        ğŸ“š Training on 6031 samples...
        Global RMSE:    749.44 MW
        Corrected RMSE: 734.33 MW
        Improvement:    2.02%
        âŒ NOT saved (improvement < 5.0%)
[31/36] Training residual model for state: TN
        ğŸ“š Training on 6031 samples...
        Global RMSE:    48053.80 MW
        Corrected RMSE: 44421.36 MW
        Improvement:    7.56%
        âœ… SAVED (improvement > 5.0%)
[32/36] Training residual model for state: TR
        ğŸ“š Training on 6031 samples...
        Global RMSE:    196.17 MW
        Corrected RMSE: 680.04 MW
        Improvement:    -246.65%
        âŒ NOT saved (improvement < 5.0%)
[33/36] Training residual model for state: TS
        ğŸ“š Training on 6032 samples...
        Global RMSE:    1135.30 MW
        Corrected RMSE: 2666.80 MW
        Improvement:    -134.90%
        âŒ NOT saved (improvement < 5.0%)
[34/36] Training residual model for state: UK
        ğŸ“š Training on 6032 samples...
        Global RMSE:    2236.82 MW
        Corrected RMSE: 3425.71 MW
        Improvement:    -53.15%
        âŒ NOT saved (improvement < 5.0%)
[35/36] Training residual model for state: UP
        ğŸ“š Training on 6031 samples...
        Global RMSE:    2335.59 MW
        Corrected RMSE: 4832.80 MW
        Improvement:    -106.92%
        âŒ NOT saved (improvement < 5.0%)
[36/36] Training residual model for state: WB
        ğŸ“š Training on 6031 samples...
        Global RMSE:    732.48 MW
        Corrected RMSE: 1846.55 MW
        Improvement:    -152.10%
        âŒ NOT saved (improvement < 5.0%)

================================================================================
TRAINING SUMMARY
================================================================================

âœ… GLOBAL MODEL:
   Test RMSE: 8537.60 MW
   Test MAPE: 5.71%
   Location:  C:\Users\DEV\Desktop\Minor Project\models\global_model.joblib
   Input Format: DataFrame with 16 features

âœ… PER-STATE RESIDUAL MODELS:
   Total states: 36
   States with residual models: 6
   States: AN, AR, GA, LA, LD, TN
   Location: C:\Users\DEV\Desktop\Minor Project\models\state_models

ğŸ“Š DETAILED RESULTS:
   Saved to: C:\Users\DEV\Desktop\Minor Project\models\training_results. csv

================================================================================
Top 10 states by improvement:
================================================================================
 1.  LD | RMSE:    42.44 â†’    18.79 | Improvement:  55.72% | âœ… SAVED
 2.  AN | RMSE:    46.06 â†’    22.32 | Improvement:  51.53% | âœ… SAVED
 3.  LA | RMSE:  2910.36 â†’  1762.47 | Improvement:  39.44% | âœ… SAVED
 4.  AR | RMSE:  1080.70 â†’   781.38 | Improvement:  27.70% | âœ… SAVED
 5.  GA | RMSE:   104.97 â†’    86.80 | Improvement:  17.31% | âœ… SAVED
 6.  TN | RMSE: 48053.80 â†’ 44421.36 | Improvement:   7.56% | âœ… SAVED
 7.  MH | RMSE:  9484.56 â†’  9265.62 | Improvement:   2.31% | âŒ REJECTED
 8.  SK | RMSE:   749.44 â†’   734.33 | Improvement:   2.02% | âŒ REJECTED
 9.  RJ | RMSE: 12687.85 â†’ 12804.46 | Improvement:  -0.92% | âŒ REJECTED
10.  KA | RMSE:  1696.38 â†’  1824.29 | Improvement:  -7.54% | âŒ REJECTED

================================================================================
Bottom 10 states (least improvement):
================================================================================
 1.  MZ | RMSE:   120.96 â†’   833.21 | Improvement: -588.83% | âŒ REJECTED
 2.  NL | RMSE:   173.46 â†’   800.18 | Improvement: -361.31% | âŒ REJECTED
 3.  AS | RMSE:   361.44 â†’  1644.17 | Improvement: -354.89% | âŒ REJECTED
 4.  ML | RMSE:   100.96 â†’   456.40 | Improvement: -352.04% | âŒ REJECTED
 5.  PD | RMSE:   143.83 â†’   595.89 | Improvement: -314.29% | âŒ REJECTED
 6.  MN | RMSE:   297.86 â†’  1227.11 | Improvement: -311.98% | âŒ REJECTED
 7. DNHD | RMSE:   410.27 â†’  1644.82 | Improvement: -300.91% | âŒ REJECTED
 8.  TR | RMSE:   196.17 â†’   680.04 | Improvement: -246.65% | âŒ REJECTED
 9.  HR | RMSE:  1151.70 â†’  3989.86 | Improvement: -246.43% | âŒ REJECTED
10.  OD | RMSE:   564.16 â†’  1781.67 | Improvement: -215.81% | âŒ REJECTED

################################################################################
# âœ… TRAINING COMPLETE - ALL MODELS READY FOR PRODUCTION
# Consumer pipeline expects SAME input format - NO CHANGES NEEDED
################################################################################
